<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Custom Search Engine Demo - CRGREP Example</title>
    <link rel="shortcut icon" href="data:image/png;base64,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" type="image/x-icon" />
    <meta name="author" content="CWaYNe">
    <meta name="contact" content="thechangwayne@gmail.com">
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/react-bootstrap/0.28.3/react-bootstrap.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css" rel='stylesheet' type='text/css'>-->
    <link href='https://fonts.googleapis.com/css?family=Londrina+Solid' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.1/react.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.1/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.7.1/browser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.min.js"></script>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
       
    <!--<link rel=stylesheet type="text/css" href="css/main.css">-->
    <link rel=stylesheet type="text/css" href="css/mui.css">
  </head>
  <body class="">
      <div id="content" class="container"></div>
      <script type="text/babel">

      var SearchBox = React.createClass({
        handleCommandSubmit: function(commands){
          var data = this.state.data;
          this.setState({data: []});
          $(".progress").removeClass( "hide" );
          $(".Info").addClass( "hide" );
          $.ajax({
            url: this.props.url,
            dataType: 'json',
            type: 'post',
            cache: false,
            data: commands,
            success: function(data){
              console.log(data);
              // var data = JSON.parse(data);
              var info = data.slice(0, 1);
              var src = data.slice(1,2)[0]['src'];
              
              console.log("src: ", src);
              this.setState({data:data.slice(2),info: info});
              //console.log(data);
              $(".Info").removeClass( "hide" );
              $(".progress").addClass( "hide" );
            }.bind(this),
            error: function(xhr, status, err){
              //this.setState({data:JSON.parse(data)});
              console.log(this.props.url, status, err.toString());
            }.bind(this)
          });
        },
        getInitialState: function(){
          return {data:[],info: []};
        },
        render: function(){

          return (
            <div className="search-box">
              <SearchForm onCommandSubmit={this.handleCommandSubmit}/>
              {/*<div className="result-box">
                {this.state.data}
              </div>*/}
              <RecordInfo info={this.state.info} />

              <div className="progress hide">
                  <div className="indeterminate"></div>
              </div>

              <RecordList data={this.state.data}  />
                  
            </div>


          );
        }
      });

      var Info = React.createClass({
        render: function(){
          return (
            <div className="QueryInfo row">
             <br/>
             <div className="col s6 offset-s3 center card-panel green lighten-3">
               <h5>{this.props.count} results</h5>
             </div>

            </div>
          );
        }
      });

      var RecordInfo = React.createClass({
        render: function(){
          var QueryInfo = this.props.info.map(function(info){
            return (
              <Info key="info" count={info.resultCount}>
              </Info>
            );
          });
          return (
            <div className="Info">
              {QueryInfo}
            </div>
          );
        }
      });
      
      var RecordList = React.createClass({
      render: function(){
        var RecordNodes = this.props.data.map(function(record){
          return (
            <Record title={record.title} score={record.score}>
            </Record>
          );
        });

        return (
          <div className="recordlist row">
            {RecordNodes}
          </div>
        );
      }
      });

    var Record = React.createClass({
      render: function(){
        return (
          <div className="col l8 offset-l2 m8 offset-m2 s10 offset-s1 card-panel hoverable">
            <h5 className="recordTitle">
              Book: {this.props.title}
            </h5>
            <h6>
              Score: {this.props.score}
            </h6>
          </div>
        );
      }
    });


      var SearchForm = React.createClass({
        handleCommandChange: function(event){
          this.setState({query_text: event.target.value});
        },
        handleDistanceChanged: function(event){
          this.setState({distance: event.target.value})
        },
        handleoutputAscendOrderChanged: function(event){
          this.setState({outputAscendOrder: !this.state.outputAscendOrder});
        },
        handleOuputSizeChange: function(event){
          this.setState({outputSize: event.target.value})
        },
        handleSubmit: function(event){
          event.preventDefault();
          var query = this.state.query_text.trim();
          var checkbox = this.state.outputAscendOrder;
          var outputSize = this.state.outputSize;
          var distance = this.state.distance;
          if(!query){
            return ;
          }
          this.props.onCommandSubmit({query:query, checkbox: checkbox, outputSize: outputSize, distance: distance});
          this.setState({query:query, checkbox: checkbox});
        },
        getInitialState: function(){
          return {
            query_text: '',
            query: '',
            outputAscendOrder: false,
            outputSize: '-1',
            distance: '0'
          }
        },
        render: function(){
          return (
            <form className="search-form" onSubmit={this.handleSubmit}>

              <div className="center-align logo light-blue-text text-darken-1" >
                Custom Search
              </div>

              <div className="row">
                <div className="input-field col s8 offset-s2 card-panel teal lighten-5">
                  <input type="text" onChange={this.handleCommandChange} placeholder="Search query" id="query"/>
                </div>

              </div>



              <div id="modal1" className="modal">
                <div className="modal-content">
                  <h4 className="center-align">Advanced Setting</h4>
                  <div className="row">
                    <div className="input-field col m6 offset-m3 s12">
                        <input type="checkbox" name="optionsRadios" className="filled-in" id="optionsRadios1" value={this.state.outputAscendOrder} onChange={this.handleoutputAscendOrderChanged}/>
                        <label htmlFor="optionsRadios1">Ascend Output Order</label>
                    </div>
                    <br/>
                    <div className="input-field col s12 m3 offset-m3">
                      <input type="number" min="0" placeholder="Result Output count" id="-s" onChange={this.handleOuputSizeChange} className="form-control"/>
                    </div>

                    <div className="input-field col s12 m3">
                        <input type="number" min="0" step="1" max="10" placeholder="Distance" id="-d" onChange={this.handleDistanceChanged} className="form-control"/>
                    </div>
                  </div>
                </div>

                <div className="modal-footer">
                  <a href="#!" className=" modal-action modal-close waves-effect waves-green btn-flat">confirm</a>
                </div>
              </div>
                      


              <div className="center">
                <button type="submit" value="query" className="btn-large btn-default">
                  <i className="material-icons right">search</i>Search
                </button>
                <button className="waves-effect waves-light btn-large modal-trigger settings" href="#modal1">Setting</button>
              </div>

            </form>
          );
        }
      });

      ReactDOM.render(
        <SearchBox url="/search" />,
        document.getElementById('content')
      );

      $(document).ready(function(){
          // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
        $('.modal-trigger').leanModal();
      });
      </script>



  </body>
</html>
